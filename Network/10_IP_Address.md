# IP Address

> Reference: [책] IT 엔지니어를 위한 네트워크 입문

<br>

<br>

- OSI 7계층에서 주소를 갖는 계층은 **2계층**과 **3계층**이다
  - 2계층은 **물리 주소**인 **MAC 주소**를 사용하고,
  - 3계층은 **논리 주소**인 **IP 주소**를 사용한다
- 대부분의 Network가 `TCP/IP`로 동작하므로 IP 주소 체계를 이해하는 것이 중요하다
- IP 주소를 포함한 다른 protocol stack의 **3계층 주소**는 아래과 같은 특성을 가진다
  1. 사용자가 **변경 가능**한 **논리 주소**이다
  2. 주소에 **level**이 있다
     - **Group**을 의미하는 `network 주소`와 `host 주소`로 나뉜다

<br>

<br>

## 1. IP 주소 체계

- 우리가 흔히 사용하는 IP 주소는 **32비트**인 **IPv4** 주소이다
  - IP는 **v4**, **v6** 두 체계가 사용되며 **IPv6** 주소는 **128비트**이다
- IPv4 주소를 표기할 때는 4개의 **옥텟 (octet)**이라고 부르는 **8비트 단위**로 나뉘고, 각 octet은 **"."** 으로 구분한다
  - `IPv4 주소`: 8비트 x 4 = 32비트
- 2계층의 `MAC 주소`가 **16진수**로 표기된 것과 달리 `IP 주소`는 **10진수**로 표기하므로 **8비트 옥텟**은 **0 ~ 255**의 값을 가질 수 있다
- 2계층 주소인 `MAC 주소`가 제조업체 코드인 **OUI**와 제조업체별 일련 번호인 **UAA** 두 부분으로 나뉘는 것과 목적이 다르지만, 
  - 3계층 주소인 `IP 주소`도 **네트워크 주소**와 **호스트 주소** 두 부분으로 나뉜다
    - **네트워크 주소**
      - Host들을 모은 network를 지칭하는 주소
      - Network 주소가 동일한 network를 **Local Network**라고 한다
    - **호스트 주소**
      - 하나의 network 내에 존재하는 host를 구분히기 위한 주소
- `MAC 주소`는 24비트씩 절반으로 나뉘지만, `IP 주소`의 **네트워크 주소**와 **호스트 주소**는 이둘을 구분하는 **경계점이 고정되어 있지 않다**
  - 이것이 다른 주소 체계와 IP 주소 체계를 구분하는 가장 큰 특징이다
  - IP 주소 체계는 필요한 **호스트 IP 개수**에 따라 **네트워크의 크기를 다르게 할당**할 수 있는 `Class 개념`을 도입했다
- 네트워크 주소와 호스트주소를 나누는 **구분자**가 **고정**되어 있다면 네트워크가 가질 수 있는 `호스트 IP 주소` 숫자가 같기 때문에 **같은 크기의 네트워크**가 되지만,
  -  **구분자를 이동할 수 있어** 네트워크 크기가 달라질 수 있다
- `IP 주소`가 도입한 **class 개념**은 다른 고정된 네트워크 주소 체계에[ 베히 **주소를 절약할 수 있다**는 장점이 있다
  - 네트워크의 크기가 모두 같은 경우, 
    - 큰 네트워크를 필요로 하는 조직은 네트워크를 **여러개 확보**해야하는 어려움이 있고, **연속된 네트워크**를 할당받기 어렵다
    - 작은 네트워크를 필요로 하는 조직은 **너무 많은 IP**를 가져가므로 **IP가 낭비**된다
- A, B, C Class는 맨 앞의 옥텟의 주소만 보고 구분할 수 있다

<br>

### Classful Network

<br>

#### A Class

- 가장 큰 주소를 갖는다
- 약 1,600만개의 IP 주소를 가질 수 있다
- **첫 번째 옥텟**에 네트워크와 호스트 주소를 나누는 **구분자**가 있다
  - 이 구분자를 `서브넷 마스크`라고 한다!
- `네트워크 주소`를 표현하는 부분이 1개의 옥텟, `호스트 주소`를 나타낼 수 있는 옥텟이 3개이기 때문에 
  - **2^8 (256)**개의 네트워크와
  - 한 네트워크 당 **2^24 (16,666,216)**개의 호스트 주소를 갖는다
- A, B, C class는 맨 앞의 옥텟 주소만 보고도 구분할 수 있는데, 옥텟 주소가 `0 ~ 127` 의 볌위이면 이 주소는 A Class이다
  - 즉, 2진수로 첫 옥텟이 `0 0000000 ~ 0 1111111`인 주소가 A Class가 된다
  - `127`만 예외로 자신을 의미하는 **Loopback 주소**로 사용되므로, 실제로 A Class로 사용할 수 있는 주소는 `1.0.0.0 ~ 126.255.255.255` 까지이다

<br>

<br>

#### B Class

- 약 6만 5천개의 IP 주소를 갖는다 
- **두번째 옥텟**에 **구분자**가 있다
- `네트워크 주소 부분`이 2개의 옥텟, `호스트 주소`가 2개의 옥텟이기 때문에
  - **2^16 (65,536)**개의 네트워크와
  - 1개의 네트워크에 **2^16(65,536)**개의 호스트주소를 갖는다
- 첫 옥텟을 2진수로 표기했을 때 **첫번째 자리가 1**이고, **두번째 자리가 0**인 주소가 B class이다
  - 2진수로 첫 옥텟이 `10 000000 ~ 10 111111` 인 수이고,
  - 10진수로 표현하면 128부터 191까지인 주소가 B Class이다

<br>

<br>

#### C Class

- **세번재 옥텟**에 **구분자**가 있다
- `네트워크 주소 부분`이 3개의 옥텟, `호스트 주소`가 1개의 옥텟이기 때문에
  - **2^24 (16,777,216)**개의 네트워크와
  - 1개의 네트워크 당 **2^8 (256)**개의 호스트를 가질 수 있다
- 첫 옥탯을 2진수로 표기했을 때 2진수 8자리 중 **첫 번째, 두 번째 자리가 1**이고, **세 번째 자리가 0**인 주소가 C Classs이다
  - 첫 옥텟이 2진수로 `110 00000 ~ 110 11111` 이고,
  - 10진수로 192 부터 223까지 IP인 경우 C class이다

<br>

Class 기반의 네트워크 분할 기법은 **과거에 사용했던 개념**으로 현재는 class 기반으로 네트워크를 분할하지 않는다

보다네트워크 주소를 세밀하게 분하랗고 할당하기 위해 **필요한 네트워크의 크기**에 맞추어 **1비트  단위**로 네트워크를 **상세히 분할**하는 방법을 사용한다 

<br>

`+`

### 네트워크에서 사용 가능한 호스트 개수 파악하기

- IP 네트워크에서는 **네트워크 크기가 변경**되므로 **하나의 네트워크에서 사용 가능한** `host의 개수`와 `유효 IP 범위`를 파악하는 것이 중요하다
  - Class 단위로 네트워크가 분할되는 경우, 쉽게 인지할 수 있는 10진수 형태로 표현되어 이해하는데 큰 무리가 없지만 `Classless Network`인 경우, 유효 IP 범위 파악이 매우 중요하다
- 일반적으로 표현할 수 있는 모든 수의 개수는 **진수^자릿수**의 형태로 계산할 수 있다
  - ex) 우리가 사용하는 10진수 4자리가 나타낼 수 있는 총 수는 10^4개이다
    - 0000부터 9999까지 10,000개의 숫자를 표현할 수 있다
- IP는 2진수로 나타내므로 **2^자릿수** 형태로 표현할 수 있는 IP 숫자를 구할 수 있다
  - 한 옥텟이 2진수 8자리이므로 A Class는 2^24개, B Class는 2^16개, C Class는 2^8개의 IP를 표현할 수 있다
  - but, IP 체계에서 **맨 앞의 숫자**를 `네트워크 주소`로, **맨 뒤의 숫자**를 `브로드캐스트 주소`로 사용하므로 실제로 사용할 수 있는 IP는 **A Class** `2^24 - 2`개, **B Class** `2^16 -2` 개, **C Class** `2^8 -2`개이다

<br>

<br>

## 2. Classful and Classless Network

- IP 주소 체계를 처음 만들었을 때는 Class 개념을 도입한 것이 **확장성** 있고, 주소 낭비가 적은 쵲거의 조건을 만들 수 있었던 좋은 선택이었따
  - `Classful Network` 에서는 **네트워크 주소**와 **호스트 주소**를 구분짓는 구분자 (`Subnet mask`)가 필요 없었다
  - 맨 앞자리 숫자만 보면 자연스럽게 이 주소가 어느 class에 속해 있는지 구분할 수 있고, 주소 구분자를 적용할 수 있었다

<br>

### Classless Network

- 인터넷이 상용화되면서 인터넷에 연결되는 host 숫자가 폭발적으로 증가했다
  - 기존 `Classful` 기반의 주소 체계는 **확장성**과 **효율성**을 모두 잡는 좋은 주소 체계였지만, 기하급수적으로 늘어나는 IP 주소 요구를 감당하기에는 너무 부족했다
    - 또한 네트워크 주소를 **계층화**하고 **분할**하기 위해 **낭비되는 IP**가 매우 많았다
- IP 주소 부족과 낭비 문제를 해결하기 위해 만든 3가지 보존, 전환 전략은 아래와 같다  
  1. 단기 대책 - `Classless`, `CIDR (Classless Inter-Domain Routing)` 기반의 주소 체계
  2. 중기 대책 - `NAT` 와 `사설 IP 주소`
  3. 장기 대책 - 차세대 IP인 `IPv6`
- `IPv4`의 가장 큰 문제는 주소 자체의 부족도 있지만 상위 Class (A Class)를 할당받은 조직에서 이 주소들을 제대로 사용하지 못하면서 낭비되는 것이었다
  - `Classful`에서는 한 개의 class network가 한 조직에 할당되면 아무리 비어 있는 주소라도 **IP를 분할**해 **다른 기관이 사용하도록 할 수 없다**
    - 이 문제를 해결하기 위해 class 개념 자체를 버리는데 이를 `Classless network`라고 부른다
      - 현재 우리가 사용하는 주소 체계는 Class 개념을 적용하지 않은 **Classless 기반의 주소 체계**이다
- `Classless Network`에서는 별도로 network와 host 주소를 나누는 구분자를 사용해야 하는데, 이 구분자를 **Subnet Mask** 라고 부른다
  - `Subnet Mask`는 **IP 주소**와 **Network 주소**를 구분할 때 사용하는데 2진수 숫자 1은 **Network 주소**, 0은 **Host 주소**로 표시한다
    - 보통 10진수를 이용하여 `255.0.0.0`, `255.255.0.0`, `255.255.255.0`과 같이 표현한다
    - 2진수 11111111을 10진수로 표현하면 255가 되어 255는 **Network 주소**부분, 0은 **Host 주소 부분**으로 구분된다
      - ex) `103.9.32.146` 주소에 `255.255.255.0` subnet mask를 사용하는 IP는
        - Network 주소가 103.9.32.0 이고,
        - Host 주소는 0.0.146이 된다
  - Classless 기반의 IT Network에서는 Netowork를 표현하는 데 반드시 subnet mask가 필요하고 server나 PC에 IP 주소를 부여할 때도 사용되어야 한다

<br>

### Subnet Mask 표현 방법

- Subnet mask를 표현하는 방법은 **비트 단위로 표현**하는 방법과 **10진수로 표현**하는 방법을 사용한다
  - **비트 단위로 표현**하는 방법은 Subnet Mask에서 1 부분이 연속된 자릿수를 표현해주는 것이다
    - A Class를 subnet mask로 나타내면 첫 Octet이 1, 나머지 Octet이 0이므로 `/8`로 표현한다
    - B Class는 `/16`,
    - C Class는 `/24` 로 표기한다
  - **10진수로 표현**할 때,
    - A Class는 `255.0.0.0`,
    - B Class는 `255.255.0.0` ,
    - C Class는 `255.255.255.0` 으로 쓴다

